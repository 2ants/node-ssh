module.exports=function(){function t(t){"use strict";var r=[];if("undefined"==typeof t.username&&r.push(new i("You must specify a valid username")),"undefined"==typeof t.host&&r.push(new i("You must specify a valid host")),"undefined"==typeof t.privateKey?r.push(new i("You must specify path to a privateKey")):n.existsSync(t.privateKey)?n.lstatSync(t.privateKey).isFile()||r.push(new i("The privateKey specified isn't page")):r.push(new i("The privateKey specified doesn't exist")),r.length>0)throw r;t.privateKey=n.readFileSync(t.privateKey),t.port=t.port||22,this.config=t,this.status=!1;try{this.conn=new e}catch(i){throw[i]}}var e=require("ssh2"),n=require("fs"),r=require("a-promise");return t.prototype.connect=function(){"use strict";var t=this;return new r(function(e,n){try{t.conn.on("error",n),t.conn.on("ready",function(){t.status=!0,e()}),t.conn.connect(t.config)}catch(r){n(r)}})},t.prototype.exec=function(t,e){"use strict";var n=this;return e=e||{},new r(function(r,i){return n.status?(e.cwd&&(t="cd "+e.cwd+"; "+t),void n.conn.exec(t,function(t,e){if(t)return i(t);var n={stdout:"",stderr:""};e.on("close",function(){n.stdout=n.stdout.toString(),n.stderr=n.stderr.toString(),r(n)}).on("data",function(t){n.stdout=t}).stderr.on("data",function(t){n.stderr=t})})):i("Not yet connected to server")})},t.prototype.put=function(t,e){"use strict";var i=this;return new r(function(r,o){return n.existsSync(t)?void i.conn.sftp(function(n,s){return n?o(n):void s.fastPut(t,e,{},function(n){return n?void("No such file"===n.message?i.mkdir(e.split("/").slice(0,-1).join("/")).then(function(){i.put(t,e).then(r)}):o(n)):r()})}):o("Local File doesn't exist")})},t.prototype.mkdir=function(t){"use strict";return this.exec("mkdir -p "+t)},t}();